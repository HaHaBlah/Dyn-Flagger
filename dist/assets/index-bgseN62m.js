(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function l(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerPolicy&&(d.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?d.credentials="include":i.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(i){if(i.ep)return;i.ep=!0;const d=l(i);fetch(i.href,d)}})();var Qe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},be={exports:{}},jt=be.exports,Ye;function Pt(){return Ye||(Ye=1,(function(o,u){(function(l,a,i){var d=u&&!u.nodeType&&u,f=o&&!o.nodeType&&o,m=d&&f&&typeof Qe=="object"&&Qe,T=f&&f.exports===d&&d;m&&(m.global===m||m.window===m||m.self===m)&&(l=m),i(d&&f?T?f.exports:d:l[a]={})})(jt,"luaparse",function(l){l.version="0.3.1";var a,i,d,f,m,T=l.defaultOptions={wait:!1,comments:!0,scope:!1,locations:!1,ranges:!1,onCreateNode:null,onCreateScope:null,onDestroyScope:null,onLocalDeclaration:null,luaVersion:"5.1",encodingMode:"none"};function g(e,t){return t=t||0,e<128?String.fromCharCode(e):e<2048?String.fromCharCode(t|192|e>>6,t|128|e&63):e<65536?String.fromCharCode(t|224|e>>12,t|128|e>>6&63,t|128|e&63):e<1114112?String.fromCharCode(t|240|e>>18,t|128|e>>12&63,t|128|e>>6&63,t|128|e&63):null}function S(e,t){for(var n=e.toString(16);n.length<t;)n="0"+n;return n}function N(e){return function(t){var n=e.exec(t);if(!n)return t;w(null,b.invalidCodeUnit,S(n[0].charCodeAt(0),4).toUpperCase())}}var q={"pseudo-latin1":{fixup:N(/[^\x00-\xff]/),encodeByte:function(e){return e===null?"":String.fromCharCode(e)},encodeUTF8:function(e){return g(e)}},"x-user-defined":{fixup:N(/[^\x00-\x7f\uf780-\uf7ff]/),encodeByte:function(e){return e===null?"":e>=128?String.fromCharCode(e|63232):String.fromCharCode(e)},encodeUTF8:function(e){return g(e,63232)}},none:{discardStrings:!0,fixup:function(e){return e},encodeByte:function(e){return""},encodeUTF8:function(e){return""}}},K=1,J=2,Y=4,G=8,ce=16,z=32,ue=64,fe=128,pe=256;l.tokenTypes={EOF:K,StringLiteral:J,Keyword:Y,Identifier:G,NumericLiteral:ce,Punctuator:z,BooleanLiteral:ue,NilLiteral:fe,VarargLiteral:pe};var b=l.errors={unexpected:"unexpected %1 '%2' near '%3'",unexpectedEOF:"unexpected symbol near '<eof>'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'",decimalEscapeTooLarge:"decimal escape too large near '%1'",invalidEscape:"invalid escape sequence near '%1'",hexadecimalDigitExpected:"hexadecimal digit expected near '%1'",braceExpected:"missing '%1' near '%2'",tooLargeCodepoint:"UTF-8 value too large near '%1'",unfinishedLongString:"unfinished long string (starting at line %1) near '%2'",unfinishedLongComment:"unfinished long comment (starting at line %1) near '%2'",ambiguousSyntax:"ambiguous syntax (function call x new statement) near '%1'",noLoopToBreak:"no loop to break near '%1'",labelAlreadyDefined:"label '%1' already defined on line %2",labelNotVisible:"no visible label '%1' for <goto>",gotoJumpInLocalScope:"<goto %1> jumps into the scope of local '%2'",cannotUseVararg:"cannot use '...' outside a vararg function near '%1'",invalidCodeUnit:"code unit U+%1 is not allowed in the current encoding mode"},v=l.ast={labelStatement:function(e){return{type:"LabelStatement",label:e}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(e){return{type:"GotoStatement",label:e}},returnStatement:function(e){return{type:"ReturnStatement",arguments:e}},ifStatement:function(e){return{type:"IfStatement",clauses:e}},ifClause:function(e,t){return{type:"IfClause",condition:e,body:t}},elseifClause:function(e,t){return{type:"ElseifClause",condition:e,body:t}},elseClause:function(e){return{type:"ElseClause",body:e}},whileStatement:function(e,t){return{type:"WhileStatement",condition:e,body:t}},doStatement:function(e){return{type:"DoStatement",body:e}},repeatStatement:function(e,t){return{type:"RepeatStatement",condition:e,body:t}},localStatement:function(e,t){return{type:"LocalStatement",variables:e,init:t}},assignmentStatement:function(e,t){return{type:"AssignmentStatement",variables:e,init:t}},callStatement:function(e){return{type:"CallStatement",expression:e}},functionStatement:function(e,t,n,s){return{type:"FunctionDeclaration",identifier:e,isLocal:n,parameters:t,body:s}},forNumericStatement:function(e,t,n,s,c){return{type:"ForNumericStatement",variable:e,start:t,end:n,step:s,body:c}},forGenericStatement:function(e,t,n){return{type:"ForGenericStatement",variables:e,iterators:t,body:n}},chunk:function(e){return{type:"Chunk",body:e}},identifier:function(e){return{type:"Identifier",name:e}},literal:function(e,t,n){return e=e===J?"StringLiteral":e===ce?"NumericLiteral":e===ue?"BooleanLiteral":e===fe?"NilLiteral":"VarargLiteral",{type:e,value:t,raw:n}},tableKey:function(e,t){return{type:"TableKey",key:e,value:t}},tableKeyString:function(e,t){return{type:"TableKeyString",key:e,value:t}},tableValue:function(e){return{type:"TableValue",value:e}},tableConstructorExpression:function(e){return{type:"TableConstructorExpression",fields:e}},binaryExpression:function(e,t,n){var s=e==="and"||e==="or"?"LogicalExpression":"BinaryExpression";return{type:s,operator:e,left:t,right:n}},unaryExpression:function(e,t){return{type:"UnaryExpression",operator:e,argument:t}},memberExpression:function(e,t,n){return{type:"MemberExpression",indexer:t,identifier:n,base:e}},indexExpression:function(e,t){return{type:"IndexExpression",base:e,index:t}},callExpression:function(e,t){return{type:"CallExpression",base:e,arguments:t}},tableCallExpression:function(e,t){return{type:"TableCallExpression",base:e,arguments:t}},stringCallExpression:function(e,t){return{type:"StringCallExpression",base:e,argument:t}},comment:function(e,t){return{type:"Comment",value:e,raw:t}}};function h(e){if(B){var t=M.pop();t.complete(),t.bless(e)}return i.onCreateNode&&i.onCreateNode(e),e}var Fe=Array.prototype.slice,Ie=function(e,t){for(var n=0,s=e.length;n<s;++n)if(e[n]===t)return n;return-1};Array.prototype.indexOf&&(Ie=function(e,t){return e.indexOf(t)});function at(e,t,n){for(var s=0,c=e.length;s<c;++s)if(e[s][t]===n)return s;return-1}function de(e){var t=Fe.call(arguments,1);return e=e.replace(/%(\d)/g,function(n,s){return""+t[s-1]||""}),e}var Te=function(e){for(var t=Fe.call(arguments,1),n,s,c=0,y=t.length;c<y;++c){n=t[c];for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e};Object.assign&&(Te=Object.assign),l.SyntaxError=SyntaxError;function Ve(e){return Object.create?Object.create(e,{line:{writable:!0,value:e.line},index:{writable:!0,value:e.index},column:{writable:!0,value:e.column}}):e}function w(e){var t=de.apply(null,Fe.call(arguments,1)),n,s;throw e===null||typeof e.line>"u"?(s=r-P+1,n=Ve(new SyntaxError(de("[%1:%2] %3",U,s,t))),n.index=r,n.line=U,n.column=s):(s=e.range[0]-e.lineStart,n=Ve(new SyntaxError(de("[%1:%2] %3",e.line,s,t))),n.line=e.line,n.index=e.range[0],n.column=s),n}function ge(e){var t=a.slice(e.range[0],e.range[1]);return t||e.value}function ee(e,t){w(t,b.expectedToken,e,ge(t))}function me(e){var t=ge(te);if(typeof e.type<"u"){var n;switch(e.type){case J:n="string";break;case Y:n="keyword";break;case G:n="identifier";break;case ce:n="number";break;case z:n="symbol";break;case ue:n="boolean";break;case fe:return w(e,b.unexpected,"symbol","nil",t);case K:return w(e,b.unexpectedEOF)}return w(e,b.unexpected,n,ge(e),t)}return w(e,b.unexpected,"symbol",e,t)}var r,p,H,te,Ae,A,U,P;l.lex=Oe;function Oe(){for(ke();a.charCodeAt(r)===45&&a.charCodeAt(r+1)===45;)mt(),ke();if(r>=d)return{type:K,value:"<eof>",line:U,lineStart:P,range:[r,r]};var e=a.charCodeAt(r),t=a.charCodeAt(r+1);if(A=r,ht(e))return it();switch(e){case 39:case 34:return lt();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Ke();case 46:return Z(t)?Ke():t===46?a.charCodeAt(r+2)===46?st():C(".."):C(".");case 61:return C(t===61?"==":"=");case 62:return f.bitwiseOperators&&t===62?C(">>"):C(t===61?">=":">");case 60:return f.bitwiseOperators&&t===60?C("<<"):C(t===61?"<=":"<");case 126:if(t===61)return C("~=");if(!f.bitwiseOperators)break;return C("~");case 58:return f.labels&&t===58?C("::"):C(":");case 91:return t===91||t===61?ot():C("[");case 47:return f.integerDivision&&t===47?C("//"):C("/");case 38:case 124:if(!f.bitwiseOperators)break;case 42:case 94:case 37:case 44:case 123:case 125:case 93:case 40:case 41:case 59:case 35:case 45:case 43:return C(a.charAt(r))}return me(a.charAt(r))}function we(){var e=a.charCodeAt(r),t=a.charCodeAt(r+1);return ve(e)?(e===10&&t===13&&++r,e===13&&t===10&&++r,++U,P=++r,!0):!1}function ke(){for(;r<d;){var e=a.charCodeAt(r);if(vt(e))++r;else if(!we())break}}function it(){for(var e,t;yt(a.charCodeAt(++r)););return e=m.fixup(a.slice(A,r)),bt(e)?t=Y:e==="true"||e==="false"?(t=ue,e=e==="true"):e==="nil"?(t=fe,e=null):t=G,{type:t,value:e,line:U,lineStart:P,range:[A,r]}}function C(e){return r+=e.length,{type:z,value:e,line:U,lineStart:P,range:[A,r]}}function st(){return r+=3,{type:pe,value:"...",line:U,lineStart:P,range:[A,r]}}function lt(){for(var e=a.charCodeAt(r++),t=U,n=P,s=r,c=m.discardStrings?null:"",y;y=a.charCodeAt(r++),e!==y;)if((r>d||ve(y))&&(c+=a.slice(s,r-1),w(null,b.unfinishedString,a.slice(A,r-1))),y===92){if(!m.discardStrings){var L=a.slice(s,r-1);c+=m.fixup(L)}var k=gt();m.discardStrings||(c+=k),s=r}return m.discardStrings||(c+=m.encodeByte(null),c+=m.fixup(a.slice(s,r-1))),{type:J,value:c,line:t,lineStart:n,lastLine:U,lastLineStart:P,range:[A,r]}}function ot(){var e=U,t=P,n=Me(!1);return n===!1&&w(p,b.expected,"[",ge(p)),{type:J,value:m.discardStrings?null:m.fixup(n),line:e,lineStart:t,lastLine:U,lastLineStart:P,range:[A,r]}}function Ke(){var e=a.charAt(r),t=a.charAt(r+1),n=e==="0"&&"xX".indexOf(t||null)>=0?ft():pt(),s=ct(),c=ut();return c&&(s||n.hasFractionPart)&&w(null,b.malformedNumber,a.slice(A,r)),{type:ce,value:n.value,line:U,lineStart:P,range:[A,r]}}function ct(){if(f.imaginaryNumbers)return"iI".indexOf(a.charAt(r)||null)>=0?(++r,!0):!1}function ut(){if(f.integerSuffixes){if("uU".indexOf(a.charAt(r)||null)>=0)if(++r,"lL".indexOf(a.charAt(r)||null)>=0){if(++r,"lL".indexOf(a.charAt(r)||null)>=0)return++r,"ULL";w(null,b.malformedNumber,a.slice(A,r))}else w(null,b.malformedNumber,a.slice(A,r));else if("lL".indexOf(a.charAt(r)||null)>=0){if(++r,"lL".indexOf(a.charAt(r)||null)>=0)return++r,"LL";w(null,b.malformedNumber,a.slice(A,r))}}}function ft(){var e=0,t=1,n=1,s,c,y,L;for(L=r+=2,ne(a.charCodeAt(r))||w(null,b.malformedNumber,a.slice(A,r));ne(a.charCodeAt(r));)++r;s=parseInt(a.slice(L,r),16);var k=!1;if(a.charAt(r)==="."){for(k=!0,c=++r;ne(a.charCodeAt(r));)++r;e=a.slice(c,r),e=c===r?0:parseInt(e,16)/Math.pow(16,r-c)}var Ee=!1;if("pP".indexOf(a.charAt(r)||null)>=0){for(Ee=!0,++r,"+-".indexOf(a.charAt(r)||null)>=0&&(n=a.charAt(r++)==="+"?1:-1),y=r,Z(a.charCodeAt(r))||w(null,b.malformedNumber,a.slice(A,r));Z(a.charCodeAt(r));)++r;t=a.slice(y,r),t=Math.pow(2,t*n)}return{value:(s+e)*t,hasFractionPart:k||Ee}}function pt(){for(;Z(a.charCodeAt(r));)++r;var e=!1;if(a.charAt(r)===".")for(e=!0,++r;Z(a.charCodeAt(r));)++r;var t=!1;if("eE".indexOf(a.charAt(r)||null)>=0)for(t=!0,++r,"+-".indexOf(a.charAt(r)||null)>=0&&++r,Z(a.charCodeAt(r))||w(null,b.malformedNumber,a.slice(A,r));Z(a.charCodeAt(r));)++r;return{value:parseFloat(a.slice(A,r)),hasFractionPart:e||t}}function dt(){var e=r++;for(a.charAt(r++)!=="{"&&w(null,b.braceExpected,"{","\\"+a.slice(e,r)),ne(a.charCodeAt(r))||w(null,b.hexadecimalDigitExpected,"\\"+a.slice(e,r));a.charCodeAt(r)===48;)++r;for(var t=r;ne(a.charCodeAt(r));)++r,r-t>6&&w(null,b.tooLargeCodepoint,"\\"+a.slice(e,r));var n=a.charAt(r++);n!=="}"&&(n==='"'||n==="'"?w(null,b.braceExpected,"}","\\"+a.slice(e,r--)):w(null,b.hexadecimalDigitExpected,"\\"+a.slice(e,r)));var s=parseInt(a.slice(t,r-1)||"0",16),c="\\"+a.slice(e,r);return s>1114111&&w(null,b.tooLargeCodepoint,c),m.encodeUTF8(s,c)}function gt(){var e=r;switch(a.charAt(r)){case"a":return++r,"\x07";case"n":return++r,`
`;case"r":return++r,"\r";case"t":return++r,"	";case"v":return++r,"\v";case"b":return++r,"\b";case"f":return++r,"\f";case"\r":case`
`:return we(),`
`;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;Z(a.charCodeAt(r))&&r-e<3;)++r;var t=a.slice(e,r),n=parseInt(t,10);return n>255&&w(null,b.decimalEscapeTooLarge,"\\"+n),m.encodeByte(n,"\\"+t);case"z":if(f.skipWhitespaceEscape)return++r,ke(),"";break;case"x":if(f.hexEscapes){if(ne(a.charCodeAt(r+1))&&ne(a.charCodeAt(r+2)))return r+=3,m.encodeByte(parseInt(a.slice(e+1,r),16),"\\"+a.slice(e,r));w(null,b.hexadecimalDigitExpected,"\\"+a.slice(e,r+2))}break;case"u":if(f.unicodeEscapes)return dt();break;case"\\":case'"':case"'":return a.charAt(r++)}return f.strictEscapes&&w(null,b.invalidEscape,"\\"+a.slice(e,r+1)),a.charAt(r++)}function mt(){A=r,r+=2;var e=a.charAt(r),t="",n=!1,s=r,c=P,y=U;if(e==="["&&(t=Me(!0),t===!1?t=e:n=!0),!n){for(;r<d&&!ve(a.charCodeAt(r));)++r;i.comments&&(t=a.slice(s,r))}if(i.comments){var L=v.comment(t,a.slice(A,r));i.locations&&(L.loc={start:{line:y,column:A-c},end:{line:U,column:r-P}}),i.ranges&&(L.range=[A,r]),i.onCreateNode&&i.onCreateNode(L),Ae.push(L)}}function Me(e){var t=0,n="",s=!1,c,y,L=U;for(++r;a.charAt(r+t)==="=";)++t;if(a.charAt(r+t)!=="[")return!1;for(r+=t+1,ve(a.charCodeAt(r))&&we(),y=r;r<d;){for(;ve(a.charCodeAt(r));)we();if(c=a.charAt(r++),c==="]"){s=!0;for(var k=0;k<t;++k)a.charAt(r+k)!=="="&&(s=!1);a.charAt(r+t)!=="]"&&(s=!1)}if(s)return n+=a.slice(y,r-1),r+=t+1,n}w(null,e?b.unfinishedLongComment:b.unfinishedLongString,L,"<eof>")}function x(){H=p,p=te,te=Oe()}function I(e){return e===p.value?(x(),!0):!1}function F(e){e===p.value?x():w(p,b.expected,e,ge(p))}function vt(e){return e===9||e===32||e===11||e===12}function ve(e){return e===10||e===13}function Z(e){return e>=48&&e<=57}function ne(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function ht(e){return!!(e>=65&&e<=90||e>=97&&e<=122||e===95||f.extendedIdentifiers&&e>=128)}function yt(e){return!!(e>=65&&e<=90||e>=97&&e<=122||e===95||e>=48&&e<=57||f.extendedIdentifiers&&e>=128)}function bt(e){switch(e.length){case 2:return e==="do"||e==="if"||e==="in"||e==="or";case 3:return e==="and"||e==="end"||e==="for"||e==="not";case 4:return e==="else"||e==="then"?!0:f.labels&&!f.contextualGoto?e==="goto":!1;case 5:return e==="break"||e==="local"||e==="until"||e==="while";case 6:return e==="elseif"||e==="repeat"||e==="return";case 8:return e==="function"}return!1}function wt(e){return z===e.type?"#-~".indexOf(e.value)>=0:Y===e.type?e.value==="not":!1}function St(e){if(K===e.type)return!0;if(Y!==e.type)return!1;switch(e.value){case"else":case"elseif":case"end":case"until":return!0;default:return!1}}var re,ie,Se;function R(){var e=re[ie++].slice();re.push(e),i.onCreateScope&&i.onCreateScope()}function $(){re.pop(),--ie,i.onDestroyScope&&i.onDestroyScope()}function Ce(e){i.onLocalDeclaration&&i.onLocalDeclaration(e),Ie(re[ie],e)===-1&&re[ie].push(e)}function he(e){Ce(e.name),ye(e,!0)}function ye(e,t){!t&&at(Se,"name",e.name)===-1&&Se.push(e),e.isLocal=t}function Be(e){return Ie(re[ie],e)!==-1}var M=[],B;function X(){return new Le(p)}function Le(e){i.locations&&(this.loc={start:{line:e.line,column:e.range[0]-e.lineStart},end:{line:0,column:0}}),i.ranges&&(this.range=[e.range[0],0])}Le.prototype.complete=function(){i.locations&&(this.loc.end.line=H.lastLine||H.line,this.loc.end.column=H.range[1]-(H.lastLineStart||H.lineStart)),i.ranges&&(this.range[1]=H.range[1])},Le.prototype.bless=function(e){if(this.loc){var t=this.loc;e.loc={start:{line:t.start.line,column:t.start.column},end:{line:t.end.line,column:t.end.column}}}this.range&&(e.range=[this.range[0],this.range[1]])};function se(){B&&M.push(X())}function V(e){B&&M.push(e)}function Q(){this.scopes=[],this.pendingGotos=[]}Q.prototype.isInLoop=function(){for(var e=this.scopes.length;e-- >0;)if(this.scopes[e].isLoop)return!0;return!1},Q.prototype.pushScope=function(e){var t={labels:{},locals:[],deferredGotos:[],isLoop:!!e};this.scopes.push(t)},Q.prototype.popScope=function(){for(var e=0;e<this.pendingGotos.length;++e){var t=this.pendingGotos[e];t.maxDepth>=this.scopes.length&&--t.maxDepth<=0&&w(t.token,b.labelNotVisible,t.target)}this.scopes.pop()},Q.prototype.addGoto=function(e,t){for(var n=[],s=0;s<this.scopes.length;++s){var c=this.scopes[s];if(n.push(c.locals.length),Object.prototype.hasOwnProperty.call(c.labels,e))return}this.pendingGotos.push({maxDepth:this.scopes.length,target:e,token:t,localCounts:n})},Q.prototype.addLabel=function(e,t){var n=this.currentScope();if(Object.prototype.hasOwnProperty.call(n.labels,e))w(t,b.labelAlreadyDefined,e,n.labels[e].line);else{for(var s=[],c=0;c<this.pendingGotos.length;++c){var y=this.pendingGotos[c];if(y.maxDepth>=this.scopes.length&&y.target===e){y.localCounts[this.scopes.length-1]<n.locals.length&&n.deferredGotos.push(y);continue}s.push(y)}this.pendingGotos=s}n.labels[e]={localCount:n.locals.length,line:t.line}},Q.prototype.addLocal=function(e,t){this.currentScope().locals.push({name:e,token:t})},Q.prototype.currentScope=function(){return this.scopes[this.scopes.length-1]},Q.prototype.raiseDeferredErrors=function(){for(var e=this.currentScope(),t=e.deferredGotos,n=0;n<t.length;++n){var s=t[n];w(s.token,b.gotoJumpInLocalScope,s.target,e.locals[s.localCounts[this.scopes.length-1]].name)}};function _(){this.level=0,this.loopLevels=[]}_.prototype.isInLoop=function(){return!!this.loopLevels.length},_.prototype.pushScope=function(e){++this.level,e&&this.loopLevels.push(this.level)},_.prototype.popScope=function(){var e=this.loopLevels,t=e.length;t&&e[t-1]===this.level&&e.pop(),--this.level},_.prototype.addGoto=_.prototype.addLabel=function(){throw new Error("This should never happen")},_.prototype.addLocal=_.prototype.raiseDeferredErrors=function(){};function He(){return f.labels?new Q:new _}function Lt(){x(),se(),i.scope&&R();var e=He();e.allowVararg=!0,e.pushScope();var t=W(e);return e.popScope(),i.scope&&$(),K!==p.type&&me(p),B&&!t.length&&(H=p),h(v.chunk(t))}function W(e){for(var t=[],n;!St(p);){if(p.value==="return"||!f.relaxedBreak&&p.value==="break"){t.push(Ge(e));break}n=Ge(e),I(";"),n&&t.push(n)}return t}function Ge(e){if(se(),z===p.type&&I("::"))return xt(e);if(f.emptyStatement&&I(";")){B&&M.pop();return}if(e.raiseDeferredErrors(),Y===p.type)switch(p.value){case"local":return x(),kt(e);case"if":return x(),At(e);case"return":return x(),Tt(e);case"function":x();var t=Bt();return De(t);case"while":return x(),Ft(e);case"for":return x(),Ot(e);case"repeat":return x(),It(e);case"break":return x(),e.isInLoop()||w(p,b.noLoopToBreak,p.value),Et();case"do":return x(),Nt(e);case"goto":return x(),Re(e)}return f.contextualGoto&&p.type===G&&p.value==="goto"&&te.type===G&&te.value!=="goto"?(x(),Re(e)):(B&&M.pop(),Ct(e))}function xt(e){var t=p,n=j();return i.scope&&(Ce("::"+t.value+"::"),ye(n,!0)),F("::"),e.addLabel(t.value,t),h(v.labelStatement(n))}function Et(){return h(v.breakStatement())}function Re(e){var t=p.value,n=H,s=j();return e.addGoto(t,n),h(v.gotoStatement(s))}function Nt(e){i.scope&&R(),e.pushScope();var t=W(e);return e.popScope(),i.scope&&$(),F("end"),h(v.doStatement(t))}function Ft(e){var t=O(e);F("do"),i.scope&&R(),e.pushScope(!0);var n=W(e);return e.popScope(),i.scope&&$(),F("end"),h(v.whileStatement(t,n))}function It(e){i.scope&&R(),e.pushScope(!0);var t=W(e);F("until"),e.raiseDeferredErrors();var n=O(e);return e.popScope(),i.scope&&$(),h(v.repeatStatement(n,t))}function Tt(e){var t=[];if(p.value!=="end"){var n=xe(e);for(n!=null&&t.push(n);I(",");)n=O(e),t.push(n);I(";")}return h(v.returnStatement(t))}function At(e){var t=[],n,s,c;for(B&&(c=M[M.length-1],M.push(c)),n=O(e),F("then"),i.scope&&R(),e.pushScope(),s=W(e),e.popScope(),i.scope&&$(),t.push(h(v.ifClause(n,s))),B&&(c=X());I("elseif");)V(c),n=O(e),F("then"),i.scope&&R(),e.pushScope(),s=W(e),e.popScope(),i.scope&&$(),t.push(h(v.elseifClause(n,s))),B&&(c=X());return I("else")&&(B&&(c=new Le(H),M.push(c)),i.scope&&R(),e.pushScope(),s=W(e),e.popScope(),i.scope&&$(),t.push(h(v.elseClause(s)))),F("end"),h(v.ifStatement(t))}function Ot(e){var t=j(),n;if(i.scope&&(R(),he(t)),I("=")){var s=O(e);F(",");var c=O(e),y=I(",")?O(e):null;return F("do"),e.pushScope(!0),n=W(e),e.popScope(),F("end"),i.scope&&$(),h(v.forNumericStatement(t,s,c,y,n))}else{for(var L=[t];I(",");)t=j(),i.scope&&he(t),L.push(t);F("in");var k=[];do{var Ee=O(e);k.push(Ee)}while(I(","));return F("do"),e.pushScope(!0),n=W(e),e.popScope(),F("end"),i.scope&&$(),h(v.forGenericStatement(L,k,n))}}function kt(e){var t,n=H;if(G===p.type){var s=[],c=[];do t=j(),s.push(t),e.addLocal(t.name,n);while(I(","));if(I("="))do{var y=O(e);c.push(y)}while(I(","));if(i.scope)for(var L=0,k=s.length;L<k;++L)he(s[L]);return h(v.localStatement(s,c))}if(I("function"))return t=j(),e.addLocal(t.name,n),i.scope&&(he(t),R()),De(t,!0);ee("<name>",p)}function Ct(e){var t,n,s,c,y,L=[];B&&(n=X());do{if(B&&(t=X()),G===p.type)y=p.value,c=j(),i.scope&&ye(c,Be(y)),s=!0;else if(p.value==="(")x(),c=O(e),F(")"),s=!1;else return me(p);e:for(;;){switch(J===p.type?'"':p.value){case".":case"[":s=!0;break;case":":case"(":case"{":case'"':s=null;break;default:break e}c=We(c,t,e)}if(L.push(c),p.value!==",")break;if(!s)return me(p);x()}while(!0);if(L.length===1&&s===null)return V(t),h(v.callStatement(L[0]));if(!s)return me(p);F("=");var k=[];do k.push(O(e));while(I(","));return V(n),h(v.assignmentStatement(L,k))}function j(){se();var e=p.value;return G!==p.type&&ee("<name>",p),x(),h(v.identifier(e))}function De(e,t){var n=He();n.pushScope();var s=[];if(F("("),!I(")"))for(;;){if(G===p.type){var c=j();if(i.scope&&he(c),s.push(c),I(","))continue}else pe===p.type?(n.allowVararg=!0,s.push(je(n))):ee("<name> or '...'",p);F(")");break}var y=W(n);return n.popScope(),F("end"),i.scope&&$(),t=t||!1,h(v.functionStatement(e,s,t,y))}function Bt(){var e,t,n;for(B&&(n=X()),e=j(),i.scope&&(ye(e,Be(e.name)),R());I(".");)V(n),t=j(),e=h(v.memberExpression(e,".",t));return I(":")&&(V(n),t=j(),e=h(v.memberExpression(e,":",t)),i.scope&&Ce("self")),e}function $e(e){for(var t=[],n,s;;){if(se(),z===p.type&&I("["))n=O(e),F("]"),F("="),s=O(e),t.push(h(v.tableKey(n,s)));else if(G===p.type)te.value==="="?(n=j(),x(),s=O(e),t.push(h(v.tableKeyString(n,s)))):(s=O(e),t.push(h(v.tableValue(s))));else{if((s=xe(e))==null){M.pop();break}t.push(h(v.tableValue(s)))}if(",;".indexOf(p.value)>=0){x();continue}break}return F("}"),h(v.tableConstructorExpression(t))}function xe(e){var t=Ue(0,e);return t}function O(e){var t=xe(e);if(t==null)ee("<expression>",p);else return t}function Dt(e){var t=e.charCodeAt(0),n=e.length;if(n===1)switch(t){case 94:return 12;case 42:case 47:case 37:return 10;case 43:case 45:return 9;case 38:return 6;case 126:return 5;case 124:return 4;case 60:case 62:return 3}else if(n===2)switch(t){case 47:return 10;case 46:return 8;case 60:case 62:return e==="<<"||e===">>"?7:3;case 61:case 126:return 3;case 111:return 1}else if(t===97&&e==="and")return 2;return 0}function Ue(e,t){var n=p.value,s,c;if(B&&(c=X()),wt(p)){se(),x();var y=Ue(10,t);y==null&&ee("<expression>",p),s=h(v.unaryExpression(n,y))}if(s==null&&(s=je(t),s==null&&(s=Ut(t))),s==null)return null;for(var L;n=p.value,L=z===p.type||Y===p.type?Dt(n):0,!(L===0||L<=e);){(n==="^"||n==="..")&&--L,x();var k=Ue(L,t);k==null&&ee("<expression>",p),B&&M.push(c),s=h(v.binaryExpression(n,s,k))}return s}function We(e,t,n){var s,c;if(z===p.type)switch(p.value){case"[":return V(t),x(),s=O(n),F("]"),h(v.indexExpression(e,s));case".":return V(t),x(),c=j(),h(v.memberExpression(e,".",c));case":":return V(t),x(),c=j(),e=h(v.memberExpression(e,":",c)),V(t),qe(e,n);case"(":case"{":return V(t),qe(e,n)}else if(J===p.type)return V(t),qe(e,n);return null}function Ut(e){var t,n,s;if(B&&(s=X()),G===p.type)n=p.value,t=j(),i.scope&&ye(t,Be(n));else if(I("("))t=O(e),F(")");else return null;for(;;){var c=We(t,s,e);if(c===null)break;t=c}return t}function qe(e,t){if(z===p.type)switch(p.value){case"(":f.emptyStatement||p.line!==H.line&&w(null,b.ambiguousSyntax,p.value),x();var n=[],s=xe(t);for(s!=null&&n.push(s);I(",");)s=O(t),n.push(s);return F(")"),h(v.callExpression(e,n));case"{":se(),x();var c=$e(t);return h(v.tableCallExpression(e,c))}else if(J===p.type)return h(v.stringCallExpression(e,je(t)));ee("function arguments",p)}function je(e){var t=J|ce|ue|fe|pe,n=p.value,s=p.type,c;if(B&&(c=X()),s===pe&&!e.allowVararg&&w(p,b.cannotUseVararg,p.value),s&t){V(c);var y=a.slice(p.range[0],p.range[1]);return x(),h(v.literal(s,n,y))}else{if(Y===s&&n==="function")return V(c),x(),i.scope&&R(),De(null);if(I("{"))return V(c),$e(e)}}l.parse=qt;var Je={"5.1":{},"5.2":{labels:!0,emptyStatement:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,relaxedBreak:!0},"5.3":{labels:!0,emptyStatement:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,unicodeEscapes:!0,bitwiseOperators:!0,integerDivision:!0,relaxedBreak:!0},LuaJIT:{labels:!0,contextualGoto:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,unicodeEscapes:!0,imaginaryNumbers:!0,integerSuffixes:!0}};function qt(e,t){if(typeof t>"u"&&typeof e=="object"&&(t=e,e=void 0),t||(t={}),a=e||"",i=Te({},T,t),r=0,U=1,P=0,d=a.length,re=[[]],ie=0,Se=[],M=[],!Object.prototype.hasOwnProperty.call(Je,i.luaVersion))throw new Error(de("Lua version '%1' not supported",i.luaVersion));if(f=Te({},Je[i.luaVersion]),i.extendedIdentifiers!==void 0&&(f.extendedIdentifiers=!!i.extendedIdentifiers),!Object.prototype.hasOwnProperty.call(q,i.encodingMode))throw new Error(de("Encoding mode '%1' not supported",i.encodingMode));return m=q[i.encodingMode],i.comments&&(Ae=[]),i.wait?l:Xe()}l.write=ze;function ze(e){return a+=String(e),d=a.length,l}l.end=Xe;function Xe(e){typeof e<"u"&&ze(e),a&&a.substr(0,2)==="#!"&&(a=a.replace(/^.*/,function(n){return n.replace(/./g," ")})),d=a.length,B=i.locations||i.ranges,te=Oe();var t=Lt();if(i.comments&&(t.comments=Ae),i.scope&&(t.globals=Se),M.length>0)throw new Error("Location tracking failed. This is most likely a bug in luaparse");return t}})})(be,be.exports)),be.exports}Pt();async function Vt(o,u="ronroblox"){try{const l=await fetch(`/api/fandom-image?filename=${encodeURIComponent(o)}&wiki=${encodeURIComponent(u)}`);if(!l.ok)throw new Error(`Failed to fetch image data: ${l.status}`);const a=await l.json();if(a.error)throw new Error(a.error);return a.url}catch(l){throw console.error(`Error fetching Fandom image URL for ${o}:`,l),l}}let D,Ze,ae,Pe,oe=null;async function Kt(){return oe=(async()=>{try{const o=await fetch("/api/fandom-data");if(!o.ok)throw new Error(`HTTP ${o.status}`);const u=await o.json();D=u.Lawnames,Ze=u.Flagdata,ae=u.Nationdata,Pe=u.Tagdata,console.log(D),console.log(Ze),console.log(ae),console.log(Pe),await tt()}catch(o){throw console.error("Error loading fandom data:",o),o}})(),oe}function Mt(o,u){let l,a,i;for(a=document.getElementsByClassName("tabcontent"),l=0;l<a.length;l++)a[l].classList.remove("tabcontent-visible"),a[l].classList.add("tabcontent-hidden");for(i=document.getElementsByClassName("tablinks"),l=0;l<i.length;l++)i[l].className=i[l].className.replace(" active","");document.getElementById(u).classList.remove("tabcontent-hidden"),document.getElementById(u).classList.add("tabcontent-visible"),o.currentTarget.className+=" active"}async function tt(){!ae?.nationdata&&oe&&(console.log("â³ Waiting for data to load..."),await oe);const o=document.getElementsByClassName("nations-list"),u=36;function l(i,d){const f=document.createElement("li"),m=document.createElement("button"),T=document.createElement("span");T.classList.add("flag-image");const g=document.createElement("img");g.src=d,T.appendChild(g);const S=document.createElement("span");return S.textContent=i,m.appendChild(T),m.appendChild(S),m.addEventListener("click",()=>Jt(i)),f.appendChild(m),f}function a(i){return i.includes("scale-to-width-down")?i.replace(/scale-to-width-down\/\d+/,`scale-to-width-down/${u}`):i.replace(/\/revision\/latest/,`/revision/latest/scale-to-width-down/${u}`)}for(let i of o){const d=i.parentElement.id;let f=[];d==="Nations"?f=Object.keys(ae.nationdata).filter(g=>ae.nationdata[g].nation===!0).sort():d==="Releasables"?f=Object.keys(ae.nationdata).filter(g=>ae.nationdata[g].nation===!1).sort():d==="Formables"&&(f=Object.values(Pe.Tags).filter(g=>g.FormableName).filter(g=>!g.Removed).map(g=>g.FormableName).sort());const m=f.map(g=>Vt(g+"_Flag.png")),T=await Promise.all(m);i.innerHTML="",f.forEach((g,S)=>{const N=a(T[S]),q=l(g,N);i.appendChild(q)})}}function Ht(){var o,u,l,a,i,d,f,m;for(o=document.getElementById("nations-search-filter"),u=o.value.toUpperCase(),l=document.getElementsByClassName("nations-list"),i=0;i<l.length;i++)for(d=l[i].getElementsByTagName("li"),a=0;a<d.length;a++)f=d[a].getElementsByTagName("span")[1],m=f.textContent||f.innerText,m.toUpperCase().indexOf(u)>-1?d[a].style.display="":d[a].style.display="none"}async function nt(o){if(!D?.lawNames&&oe&&await oe,!o){console.error("No flag div provided to generateLawsList");return}const u=o.querySelector(".laws-selection");if(console.log(u),!u){console.error("Element with class 'laws-selection' not found in flag div");return}if(!D||!D.lawNames){console.error("Lawnames data not loaded yet");return}u.innerHTML="";function l(i){const d=document.createElement("button");return d.classList.add("btn"),d.textContent=i,d}const a=Object.entries(D.lawNames).sort((i,d)=>i[1].Name.localeCompare(d[1].Name));for(let[i,d]of a){const f=l(d.Name);u.appendChild(f)}}let E={NationName:"",Flags:[]};function rt(o={}){const u={FlagName:o.FlagName||"",FlagID:o.FlagID||"",Description:o.Description||"",Ideologies:o.Ideologies||[],Laws:o.Laws||{},NOTIdeologies:o.NOTIdeologies||[],NOTLaws:o.NOTLaws||{}};return E.Flags.push(u),u}function Gt(o){E.Flags.splice(o,1)}function Ne(){console.log("Current Flag Specifications:",E);const o=document.querySelector("#nation-name");o&&(o.value=E.NationName);const u=document.querySelector(".main-content"),l=document.querySelector(".new-flag-button"),a=document.querySelectorAll(".flag");a.forEach((i,d)=>{d>=E.Flags.length&&i.remove()}),E.Flags.forEach((i,d)=>{const f=a[d];if(f)Rt(f,i,d);else{const m=$t(i,d);u.insertBefore(m,l)}})}function Rt(o,u,l){o.dataset.flagIndex=l;const a=o.querySelector(".flag-name-input");a&&a.value!==u.FlagName&&(a.value=u.FlagName);const i=o.querySelector(".flag-image-input");i&&i.value!==u.FlagID&&(i.value=u.FlagID);const d=o.querySelector(".flag-description-input");d&&d.value!==u.Description&&(d.value=u.Description),o.querySelectorAll(".ideologies button").forEach(m=>{const T=m.textContent,g=u.Ideologies.includes(T),S=u.NOTIdeologies.includes(T);m.classList.toggle("selected-ideology",g),m.classList.toggle("not-selected-ideology",S)}),le(o,l)}function le(o,u){const l=E.Flags[u],a=o.querySelector(".flag-overview-left #flag-name");a&&(a.textContent=l.FlagName||"Flag Name");const i=o.querySelectorAll(".flag-overview-right > div");if(i.length>=5){let d='<span class="flag-overview-title">Laws: </span>';const f=[];for(let g in l.Laws){const S=et(g),N=l.Laws[g];if(Array.isArray(N)&&N.length>0){const q=N.map(K=>_e(g,K));f.push(`${S}: ${q.join(", ")}`)}}d+=f.length>0?"<br>"+f.join("<br>"):"None";let m='<span class="flag-overview-title">NOT Laws: </span>';const T=[];for(let g in l.NOTLaws){const S=et(g),N=l.NOTLaws[g];if(Array.isArray(N)&&N.length>0){const q=N.map(K=>_e(g,K));T.push(`${S}: ${q.join(", ")}`)}}m+=T.length>0?"<br>"+T.join("<br>"):"None",i[0].innerHTML=`<span class="flag-overview-title">Flag ID: </span>${l.FlagID}<span class="flag-overview-content"></span>`,i[1].innerHTML=`<span class="flag-overview-title">Ideologies: </span>${l.Ideologies.join(", ")}<span class="flag-overview-content"></span>`,i[2].innerHTML=d+'<span class="flag-overview-content"></span>',i[3].innerHTML=m+'<span class="flag-overview-content"></span>',i[4].innerHTML=`<span class="flag-overview-title">Description: </span>${l.Description}<span class="flag-overview-content"></span>`}}function $t(o,u){const l=document.createElement("div");return l.classList.add("flag"),l.dataset.flagIndex=u,l.innerHTML=`
        <button class="collapse-flag-overview-button">
            <div class="flag-overview">
                <div class="flag-overview-left">
                    <img id="nation-flag" src="images/Unknown Flag.png">
                    <p id="flag-name">${o.FlagName||"Flag Name"}</p>
                </div>
                <div class="flag-overview-right">
                    <div><span class="flag-overview-title">Flag ID: </span>${o.FlagID}<span class="flag-overview-content"></span></div>
                    <div><span class="flag-overview-title">Ideologies: </span>${o.Ideologies}<span class="flag-overview-content"></span></div>
                    <div><span class="flag-overview-title">Laws: </span>${Object.keys(o.Laws)}<span class="flag-overview-content"></span></div>
                    <div><span class="flag-overview-title">NOT Laws: </span>${Object.keys(o.NOTLaws)}<span class="flag-overview-content"></span></div>
                    <div><span class="flag-overview-title">Description: </span>${o.Description}<span class="flag-overview-content"></span></div>
                </div>
            </div>
        </button>
        <div class="flag-contents">
            <button class="delete-flag-button">Delete Flag</button>
            
            <div class="flag-label"><span class="flag-title">Name: </span><input class="flag-input flag-name-input" value="${o.FlagName}"></div>
            <div class="flag-label"><span class="flag-title">Image ID: </span><input class="flag-input flag-image-input" value="${o.FlagID}"></div>
            <div class="flag-label"><span class="flag-title">Description/Sources: </span><input class="flag-input flag-description-input" value="${o.Description}"></div>
            
            <div class="ideologies">
                <ul>
                    <li>
                        <button type="button" class="btn">Non-Aligned</button>
                        <ul>
                            <li>
                                <button style="color: #F3B6B6;" type="button" class="btn">Socialism</button>
                                <ul>
                                    <li><button style="color: #F37B7B;" type="button" class="btn">Communism</button></li>
                                </ul>
                            </li>
                            <li>
                                <button style="color: #B5B6F3;" type="button" class="btn">Liberalism</button>
                                <ul>
                                    <li><button style="color: #7B7BF3;" type="button" class="btn">Democracy</button></li>
                                </ul>
                            </li>
                            <li>
                                <button style="color: #B8B8B9;" type="button" class="btn">Nationalism</button>
                                <ul>
                                    <li><button style="color: #7B7B7B;" type="button" class="btn">Fascism</button></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            
            <div class="laws">
                <div class="laws-selection">
                    <img src="https://media.tenor.com/3xTqDrUgvvIAAAAi/error-404.gif" alt="Loading..." class="loading-gif">
                </div>
                <div class="laws-name"></div>
                <div class="laws-level"></div>
            </div>
        </div>
    `,l.querySelector(".delete-flag-button").addEventListener("click",()=>{Gt(u),Ne()}),l.querySelector(".flag-name-input").addEventListener("input",g=>{E.Flags[u].FlagName=g.target.value,le(l,u)}),l.querySelector(".flag-image-input").addEventListener("input",g=>{E.Flags[u].FlagID=g.target.value,le(l,u)}),l.querySelector(".flag-description-input").addEventListener("input",g=>{E.Flags[u].Description=g.target.value,le(l,u)}),l.querySelector(".ideologies").addEventListener("click",g=>{if(g.target&&g.target.tagName==="BUTTON"){const S=g.target.textContent,N=E.Flags[u].Ideologies,q=E.Flags[u].NOTIdeologies;N.includes(S)?(E.Flags[u].Ideologies=N.filter(K=>K!==S),g.target.classList.remove("selected-ideology")):q.includes(S)?(E.Flags[u].NOTIdeologies=q.filter(K=>K!==S),g.target.classList.remove("not-selected-ideology")):(E.Flags[u].Ideologies.push(S),g.target.classList.add("selected-ideology")),le(l,u)}}),l.querySelector(".laws-selection").addEventListener("click",g=>{if(g.target&&g.target.tagName==="BUTTON"){const S=g.target.textContent;Wt(l,S)}}),nt(l),l}function Wt(o,u){const l=o.querySelector(".laws-name"),a=o.querySelector(".laws-level"),i=Xt(u);l.innerHTML=u;const d=a.cloneNode(!1);a.parentNode.replaceChild(d,a);const f=parseInt(o.dataset.flagIndex,10);for(let m in D.lawNames[i].Types){const T=D.lawNames[i].Types[m],g=document.createElement("button");g.classList.add("btn"),g.textContent=T;const S=E.Flags[f].Laws[i],N=E.Flags[f].NOTLaws[i];Array.isArray(S)&&S.includes(m)?g.classList.add("selected-law"):Array.isArray(N)&&N.includes(m)&&g.classList.add("not-selected-law"),d.appendChild(g)}d.addEventListener("click",m=>{if(m.target&&m.target.tagName==="BUTTON"){const T=m.target.textContent,g=zt(u,T);E.Flags[f].Laws[i]||(E.Flags[f].Laws[i]=[]),E.Flags[f].NOTLaws[i]||(E.Flags[f].NOTLaws[i]=[]);const S=E.Flags[f].Laws[i],N=E.Flags[f].NOTLaws[i];if(S.includes(g)){const q=S.indexOf(g);S.splice(q,1),N.push(g),m.target.classList.remove("selected-law"),m.target.classList.add("not-selected-law")}else if(N.includes(g)){const q=N.indexOf(g);N.splice(q,1),m.target.classList.remove("not-selected-law")}else S.push(g),m.target.classList.add("selected-law");S.length===0&&N.length===0?(delete E.Flags[f].Laws[i],delete E.Flags[f].NOTLaws[i]):S.length===0?delete E.Flags[f].Laws[i]:N.length===0&&delete E.Flags[f].NOTLaws[i],le(o,f)}})}function Jt(o){E.NationName=o,Ne()}function _e(o,u){return D.lawNames[o]?D.lawNames[o].Types[u]:"Law Not Found"}function zt(o,u){for(let l in D.lawNames)if(D.lawNames[l].Name===o){const a=D.lawNames[l].Types;for(let i in a)if(a[i]===u)return i}return console.log("Law Not Found for",o,u),"Law Not Found"}function et(o){if(D.lawNames[o])return D.lawNames[o].Name}function Xt(o){for(let u in D.lawNames)if(D.lawNames[u].Name===o)return u;return null}document.addEventListener("DOMContentLoaded",()=>{const o=document.querySelector(".new-flag-button button");o&&o.addEventListener("click",()=>{rt(),Ne()})});Kt();rt();Ne();window.switchTab=Mt;window.generateLawsList=nt;window.generateNationsList=tt;window.nationsSearchFilter=Ht;
